<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="theme-color" content="#111317" />
    <title>Bets Admin</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="styles_enhancements.css" />
    <link rel="stylesheet" href="admin-chat.css" />
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- Include the Dark theme -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-dark@5/dark.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>
  </head>
  <body>
    <div class="app">
      <header class="header">
        <div class="header-left">
          <div class="logo">ADM</div>
          <div>
            <div class="brand-title">BetsBot Admin</div>
            <div class="brand-subtitle">Users • Limits • Payouts</div>
          </div>
        </div>
      </header>

      <nav class="tabs" id="admin-tabs" style="display: none;">
        <button class="tab tab-active" data-tab="dashboard">Dashboard</button>
        <button class="tab" data-tab="users">Users</button>
        <button class="tab" data-tab="support">Support Chat</button>
        <button class="tab" data-tab="deposits">Deposits</button>
        <button class="tab" data-tab="payouts">Payouts</button>
        <button class="tab" data-tab="bets">Bets</button>
        <button class="tab" data-tab="credits">Credits</button>
        <button class="tab" data-tab="settings">Settings</button>
      </nav>

      <main class="page" data-page="dashboard">
        <section class="card">
          <h2>Dashboard</h2>
          <p>Overview: users, limits, bets, payout requests (demo data).</p>
          <div class="grid-3 mt">
            <div class="subcard">
              <div class="label">Users</div>
              <div class="value-large" id="stat-users">0</div>
            </div>
            <div class="subcard">
              <div class="label">Total staked</div>
              <div class="value-large" id="stat-staked">0</div>
            </div>
            <div class="subcard">
              <div class="label">Pending payouts</div>
              <div class="value-large" id="stat-pending">0</div>
            </div>
          </div>
        </section>
      </main>

      <main class="page page-hidden" data-page="users">
        <section class="card">
          <h2>Users</h2>
          <p>View players and edit credit limits.</p>
          <div class="mt">
            <input id="users-search" class="input" placeholder="Search by @tg or id..." />
          </div>
          <div class="table mt" id="users-table"></div>
        </section>
      </main>

      <main class="page page-hidden" data-page="support">
        <section class="card">
          <h2>Support Chat</h2>
          <p>Communicate with users through support chat.</p>
          <div class="admin-chat-container">
            <!-- Users List -->
            <div class="admin-chat-users-panel">
              <div class="admin-chat-users-header">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                  </svg>
                  <input id="support-users-search" class="input" placeholder="Search users..." style="flex: 1; border: none; background: transparent; padding: 8px 0;" />
                </div>
              </div>
              <div id="support-users-list" class="admin-chat-users-list">
                <div class="admin-chat-empty-state">Loading users...</div>
              </div>
            </div>
            
            <!-- Chat Window -->
            <div class="admin-chat-messages-panel">
              <div class="admin-chat-header">
                <div class="admin-chat-header-content">
                  <div class="admin-chat-header-title">
                    <span id="support-chat-user-name">Select a user to start chatting</span>
                    <span class="admin-chat-user-id" id="support-chat-user-id" style="display: none;"></span>
                  </div>
                  <span class="admin-chat-status-badge" id="support-chat-status" style="display: none;">Admin</span>
                </div>
                <button id="support-chat-back" class="admin-chat-back-btn" style="display: none;" onclick="backToUsersList()" title="Back to users">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                  </svg>
                </button>
              </div>
              <div id="support-chat-messages" class="admin-chat-messages">
                <div class="admin-chat-empty-state">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="opacity: 0.3; margin-bottom: 12px;">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                  </svg>
                  <div>Select a user from the list to view messages</div>
                </div>
              </div>
              <div id="support-chat-input-wrapper" class="admin-chat-input-wrapper" style="display: none;">
                <div class="admin-chat-input-container">
                  <input type="text" id="support-chat-input" class="admin-chat-input" placeholder="Type your message..." />
                  <button class="admin-chat-send-btn" id="support-chat-send" title="Send message">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="22" y1="2" x2="11" y2="13"></line>
                      <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>

      <main class="page page-hidden" data-page="deposits">
        <section class="card">
          <h2>Deposits</h2>
          <p>Confirm deposit requests.</p>
          <div class="mt">
            <input id="deposits-search" class="input" placeholder="Search deposits..." />
          </div>
          <div class="grid-3 mt">
            <div class="subcard">
              <div class="label">Pending</div>
              <div class="value-large" id="dstat-pending">0</div>
            </div>
            <div class="subcard">
              <div class="label">Approved</div>
              <div class="value-large" id="dstat-approved">0</div>
            </div>
            <div class="subcard">
              <div class="label">Rejected</div>
              <div class="value-large" id="dstat-rejected">0</div>
            </div>
          </div>
          <div class="table mt" id="deposits-table"></div>
        </section>
      </main>

      <main class="page page-hidden" data-page="payouts">
        <section class="card">
          <h2>Payouts</h2>
          <p>Confirm player withdrawal requests.</p>
          <div class="mt">
            <input id="payouts-search" class="input" placeholder="Search payouts..." />
          </div>
          <div class="grid-3 mt">
            <div class="subcard">
              <div class="label">Pending</div>
              <div class="value-large" id="pstat-pending">0</div>
            </div>
            <div class="subcard">
              <div class="label">Approved</div>
              <div class="value-large" id="pstat-approved">0</div>
            </div>
            <div class="subcard">
              <div class="label">Rejected</div>
              <div class="value-large" id="pstat-rejected">0</div>
            </div>
          </div>
          <div class="table mt" id="payouts-table"></div>
        </section>
      </main>

      <main class="page page-hidden" data-page="bets">
        <section class="card">
          <h2>Bets Management</h2>
          <p>Bet management: view, change statuses, detailed information.</p>
          <div class="mt">
            <input id="bets-search" class="input" placeholder="Search by bet ID, match, or user..." />
          </div>
          <div class="mt" style="display: flex; gap: 8px; flex-wrap: wrap;">
            <select id="bets-status-filter" class="input" style="flex: 1; min-width: 150px;">
              <option value="">All statuses</option>
              <option value="pending">Pending</option>
              <option value="active">Active</option>
              <option value="won">Won</option>
              <option value="lost">Lost</option>
              <option value="cancelled">Cancelled</option>
              <option value="refunded">Refunded</option>
            </select>
          </div>
          <div class="grid-3 mt">
            <div class="subcard">
              <div class="label">Total Bets</div>
              <div class="value-large" id="bstat-total">0</div>
            </div>
            <div class="subcard">
              <div class="label">Pending</div>
              <div class="value-large" id="bstat-pending">0</div>
            </div>
            <div class="subcard">
              <div class="label">Active</div>
              <div class="value-large" id="bstat-active">0</div>
            </div>
          </div>
          <div class="table mt" id="bets-table"></div>
        </section>
      </main>

      <main class="page page-hidden" data-page="credits">
        <section class="card">
          <h2>Credit Requests</h2>
          <p>Confirm credit limit increase requests.</p>
          <div class="mt">
            <input id="credits-search" class="input" placeholder="Search credit requests..." />
          </div>
          <div class="grid-3 mt">
            <div class="subcard">
              <div class="label">Pending</div>
              <div class="value-large" id="cstat-pending">0</div>
            </div>
            <div class="subcard">
              <div class="label">Approved</div>
              <div class="value-large" id="cstat-approved">0</div>
            </div>
            <div class="subcard">
              <div class="label">Rejected</div>
              <div class="value-large" id="cstat-rejected">0</div>
            </div>
          </div>
          <div class="table mt" id="credits-table"></div>
        </section>
      </main>

      <main class="page page-hidden" data-page="settings">
        <section class="card">
          <h2>Settings</h2>
          <p>Manage wallets and administrator password.</p>
          
          <div class="subcard mt">
            <h3 style="margin-top: 0;">Deposit Wallet</h3>
            <div class="mt">
              <div class="label">USDT (TRC20)</div>
              <input type="text" id="wallet-usdt" class="input" placeholder="USDT wallet address" />
            </div>
            <div class="actions-row mt">
              <button class="primary-btn" id="btn-save-wallets">Save Wallet</button>
            </div>
          </div>

          <div class="subcard mt">
            <h3 style="margin-top: 0;">Change Password</h3>
            <div class="mt">
              <div class="label">Current Password</div>
              <input type="password" id="old-password" class="input" placeholder="Current password" />
            </div>
            <div class="mt">
              <div class="label">New Password</div>
              <input type="password" id="new-password" class="input" placeholder="New password (min 8 chars)" />
            </div>
            <div class="actions-row mt">
              <button class="primary-btn" id="btn-change-password">Change Password</button>
            </div>
          </div>
        </section>
      </main>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal" style="display: flex;">
      <div class="modal-overlay"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h2>Admin Login</h2>
        </div>
        <div class="modal-body">
          <div class="subcard">
            <div class="label">Password</div>
            <input type="password" id="login-password" class="input" placeholder="Enter admin password" />
          </div>
          <div class="actions-row mt">
            <button class="primary-btn" id="btn-login">Login</button>
          </div>
          <div id="login-error" style="color: #f97373; margin-top: 10px; display: none;"></div>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>

